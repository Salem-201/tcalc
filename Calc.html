<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Ø­Ø§Ø³Ø¨Ø© ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f2f4f8;
    color: #333;
    padding: 1rem;
    display: flex;
    justify-content: center;
  }

  .container {
    background: #fff;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 1.5rem;
    max-width: 680px;
    width: 100%;
    box-sizing: border-box;
  }

  h1 {
    text-align: center;
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
  }

  input[type="text"],
  select {
    width: 100%;
    padding: 0.6rem;
    margin-top: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    box-sizing: border-box;
    direction: ltr;
    font-size: 1rem;
  }

  .row,
  .select-row {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .results {
    margin-top: 1.5rem;
    padding: 1rem;
    background: #e9f5ec;
    border-radius: 0.5rem;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .results div {
    margin-top: 0.5rem;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  #unitTotalCost {
    margin-top: 1rem;
    font-weight: bold;
    font-size: 1.1rem;
    color: #1c7c38;
  }

  .cost-display {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    gap: 0.5rem;
    font-weight: bold;
    font-size: 1.1rem;
    margin-top: 1rem;
  }

  .cost-display > div {
    flex: 1 1 45%;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }

  /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØªØ­ÙØ© Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© */
  .artifact-active {
    background: linear-gradient(135deg, #fff9e6 0%, #fff5d6 50%, #fff0c4 100%);
    border: 2px solid #ffd700;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
    position: relative;
  }

  .artifact-active::before {
    content: "âœ¨";
    position: absolute;
    top: -8px;
    right: -8px;
    font-size: 16px;
    animation: sparkle 2s ease-in-out infinite;
  }

  @keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
    50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
  }

  .artifact-active .cost-display {
    background: linear-gradient(135deg, #fff9e6 0%, #fff5d6 100%);
    border-radius: 0.5rem;
    padding: 0.5rem;
    margin-top: 0.5rem;
  }

  .artifact-active #unitTotalCost {
    color: #d4af37;
    text-shadow: 0 0 4px rgba(212, 175, 55, 0.3);
  }

  /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø´ÙŠÙƒ Ø¨ÙˆÙƒØ³ */
  #reduceCostCheckbox:checked + label {
    color: #d4af37;
    font-weight: bold;
    text-shadow: 0 0 2px rgba(212, 175, 55, 0.3);
  }

  #reduceCostCheckbox:checked {
    accent-color: #ffd700;
    transform: scale(1.1);
    transition: all 0.3s ease;
  }

  /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­ÙØ© */
  .artifact-active .results {
    background: linear-gradient(135deg, #f0f8e6 0%, #e8f5d6 100%);
    border: 1px solid #ffd700;
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.2);
  }

  .artifact-active .results div {
    color: #2d5016;
  }

  input:enabled {
    border: 2px solid #007bff;
    background-color: #ffffff;
    outline: none;
    caret-color: #007bff;
    box-shadow: 0 0 4px rgba(0, 123, 255, 0.4);
  }

  input:disabled {
    border: 1px solid #ccc;
    background-color: #f8f9fa;
    color: #888;
  }

  @media (min-width: 768px) {
    input[type="text"],
    select {
      font-size: 1rem;
    }

    .cost-display > div {
      flex: 1;
    }
  }
</style>

</head>
<body>
  <div class="container">

    <div class="select-row">
      <select id="tribeSelect" onchange="populateTroops()">
        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø¨ÙŠÙ„Ø© ğŸ° --</option>
        <option value="german">Ø§Ù„Ø¬Ø±Ù…Ø§Ù†</option>
        <option value="roman">Ø§Ù„Ø±ÙˆÙ…Ø§Ù†</option>
        <option value="gaul">Ø§Ù„Ø¥ØºØ±ÙŠÙ‚</option>
        <option value="egyptian">Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©</option>
        <option value="hun">Ø§Ù„Ù…ØºÙˆÙ„</option>
        <option value="spartan">Ø£Ø³Ø¨Ø±Ø·Ø©</option>
        <option value="viking">Ø§Ù„Ú¤Ø§ÙŠÙƒÙ†Ø¬</option>
      </select>

      <select id="troopSelect" onchange="setTroopCosts()">
        <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù†Ø¯ÙŠ âš”ï¸ --</option>
      </select>
    </div>

         <div class="cost-display">
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="woodCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="clayCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="ironCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="wheatCostText">0</span></div>
     </div>

<div id="unitTotalCost"><img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ØªÙƒÙ„ÙØ©" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> Ù…Ø¬Ù…ÙˆØ¹ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ: 0</div>

<!-- âœ… Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹ -->
<div style="margin-bottom: 10px; font-size: 14px;">
  <p>Ø§Ù„Ø­Ø³Ø§Ø¨ ÙŠØªÙ… Ø¹Ù† Ø·Ø±ÙŠÙ‚:</p>
<input type="radio" name="calcMode" value="resources" checked onchange="updateInputFieldsState(); recalculate()">  Ø§Ù„Ù…ÙˆØ§Ø±Ø¯
<input type="radio" name="calcMode" value="troops" onchange="updateInputFieldsState(); recalculate()">  Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù†ÙˆØ¯
<input type="radio" name="calcMode" value="gold" onchange="updateInputFieldsState(); recalculate()">   Ø§Ù„Ø°Ù‡Ø¨
<label>
  <input type="checkbox" id="reduceCostCheckbox" onchange="toggleArtifactEffects(); setTroopCosts(); recalculate()">
  ğŸº Ø§Ù„ØªØ­ÙØ© Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© (30% Ù…ÙˆØ§Ø±Ø¯ Ø£Ù‚Ù„)</label>
</div>

<!-- ğŸ”¢ Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ -->
<div class="row">
<input type="text" id="totalResources" placeholder="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯" oninput="formatInputWithCommas(this); onInputHandler('resources')">
<input type="text" id="customTroopCount" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø¬Ù†ÙˆØ¯" oninput="formatInputWithCommas(this); onInputHandler('troops')">
<input type="text" id="goldInput" placeholder=" Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ù‡Ø¨" oninput="formatInputWithCommas(this); onInputHandler('gold')">
</div>

    <div class="results" id="results">
      <div id="marketGoldValue">ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0</div>
      <div id="goldCost">ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;"></div>
      <div id="troopsCount">ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: 0 Ø¬Ù†Ø¯ÙŠ</div>
             <div id="totalWood"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: 0</div>
       <div id="totalClay"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: 0</div>
       <div id="totalIron"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: 0</div>
       <div id="totalWheat"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: 0</div>
       <div id="totalResourcesUsed"><img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: 0</div>
    </div>
      <button onclick="resetAll()" style="margin-top: 1rem; padding: 0.5rem 1rem; border: none; border-radius: 0.5rem; background-color: #e74c3c; color: white; font-size: 1rem; cursor: pointer;">
ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ØµÙØ­Ø©
</button>
  </div>

  <script>
    const troopData = {
      german: [
        { name: 'Ù…Ù‚Ø§ØªÙ„ Ø¨Ù‡Ø±Ø§ÙˆØ©', cost: [95, 75, 40, 40], marketRate: 800 },
        { name: 'Ù…Ù‚Ø§ØªÙ„ Ø¨Ø±Ù…Ø­', cost: [130, 120, 170, 70], marketRate: 588 },
        { name: 'Ù…Ù‚Ø§ØªÙ„ Ø¨ÙØ£Ø³', cost: [130, 120, 170, 70], marketRate: 408 },
        { name: 'Ø§Ù„ÙƒØ´Ø§Ù', cost: [160, 100, 50, 50], marketRate: 555 },
        { name: 'Ù…Ù‚Ø§ØªÙ„ Ø§Ù„Ù‚ÙŠØµØ±', cost: [370, 270, 290, 75], marketRate: 199 },
        { name: 'ÙØ±Ø³Ø§Ù† Ø§Ù„Ø¬Ø±Ù…Ø§Ù†', cost: [450, 515, 480, 150], marketRate: 131 },
        { name: 'Ù…Ø­Ø·Ù…Ø© Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨', cost: [1000, 300, 350, 300], marketRate: 110 },
        { name: 'Ø§Ù„Ù…Ù‚Ù„Ø§Ø¹', cost: [900, 1200, 600, 60], marketRate: 70 },
        { name: 'Ø§Ù„Ø²Ø¹ÙŠÙ…', cost: [35500, 26500, 25000, 80] },
        { name: 'Ù…Ø³ØªÙˆØ·Ù†', cost: [7200, 5500, 5800, 100] }
      ],
      roman: [
        { name: 'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„', cost: [120, 100, 180, 40] },
        { name: 'Ø­Ø±Ø§Ø³ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±', cost: [100, 130, 160, 70] },
        { name: 'Ø¬Ù†Ø¯ÙŠ Ù…Ù‡Ø§Ø¬Ù…', cost: [150, 120, 210, 80] },
        { name: 'ÙØ±Ù‚Ø© ØªØ¬Ø³Ø³', cost: [160, 100, 20, 40] },
        { name: 'Ø³Ù„Ø§Ø­ Ø§Ù„ÙØ±Ø³Ø§Ù†', cost: [550, 260, 360, 100] },
        { name: 'ÙØ±Ø³Ø§Ù† Ù‚ÙŠØµØ±', cost: [550, 440, 520, 100] },
        { name: 'ÙƒØ¨Ø´', cost: [900, 360, 500, 70] },
        { name: 'Ø§Ù„Ù…Ù‚Ù„Ø§Ø¹ Ø§Ù„Ù†Ø§Ø±ÙŠ', cost: [950, 1350, 900, 90] },
        { name: 'Ø­ÙƒÙŠÙ…', cost: [30750, 27000, 45000, 60] },
        { name: 'Ù…Ø³ØªÙˆØ·Ù†', cost: [5800, 5300, 7200, 100] }
      ],
      gaul: [
        { name: 'Ø§Ù„ÙƒØªÙŠØ¨Ø©', cost: [100, 110, 50, 30], marketRate: 645 },
        { name: 'Ù…Ø¨Ø§Ø±Ø²', cost: [140, 150, 185, 60], marketRate: 380 },
        { name: 'Ø§Ù„Ù…Ø³ØªÙƒØ´Ù', cost: [170, 150, 20, 40], marketRate: 530 },
        { name: 'Ø±Ø¹Ø¯ Ø§Ù„Ø¥ØºØ±ÙŠÙ‚', cost: [350, 450, 230, 60], marketRate: 190 },
        { name: 'ÙØ±Ø³Ø§Ù† Ø§Ù„Ø³Ù„Øª', cost: [360, 330, 280, 120], marketRate: 190 },
        { name: 'ÙØ±Ø³Ø§Ù† Ø§Ù„Ù‡ÙŠØ¯ÙˆØ§Ù†Ø±', cost: [500, 620, 675, 170], marketRate: 101 },
        { name: 'Ù…Ø­Ø·Ù…Ø© Ø§Ù„Ø§Ø¨ÙˆØ§Ø¨', cost: [950, 555, 330, 75], marketRate: 104 },
        { name: 'Ø§Ù„Ù…Ù‚Ù„Ø§Ø¹ Ø§Ù„Ø­Ø±Ø¨ÙŠ', cost: [960, 1450, 630, 90], marketRate: 63 },
        { name: 'Ø±Ø¦ÙŠØ³', cost: [30750, 45400, 31000, 37500] },
        { name: 'Ù…Ø³ØªÙˆØ·Ù†', cost: [5500, 7000, 5300, 4900] }
      ],
      egyptian: [
        { name: 'Ù…ÙŠÙ„ÙŠØ´ÙŠØ§', cost: [45, 60, 30, 15], marketRate: 1333 },
        { name: 'Ø­Ø§Ø±Ø³ Ø§Ù„Ø±Ù…Ø§Ø¯', cost: [115, 100, 145, 60], marketRate: 476 },
        { name: 'Ù…Ø­Ø§Ø±Ø¨ Ø®Ø§Ø¨Ø§Ø´', cost: [170, 180, 220, 80], marketRate: 307 },
        { name: 'Ø§Ù„Ù…Ø³ØªØ·Ù„Ø¹', cost: [170, 150, 20, 40], marketRate: 526 },
        { name: 'Ø­Ø§Ø±Ø³ Ø£Ù†Ø¬ÙˆØ±', cost: [360, 330, 280, 120], marketRate: 183 },
        { name: 'Ø¹Ø±Ø¨Ø© Ø±Ø´Ø¨', cost: [450, 560, 610, 180], marketRate: 111 },
        { name: 'Ù…Ø¯ÙƒÙ‘Ø§Øª', cost: [900, 360, 500, 70] },
        { name: 'Ù…Ù†Ø¬Ù†ÙŠÙ‚ Ù†Ø§Ø±ÙŠ', cost: [995, 575, 340, 80] },
        { name: 'Ø£Ù…ÙŠØ± Ø­Ø§ØªÙŠ', cost: [34000, 50000, 34000, 42000] },
        { name: 'Ø§Ù„Ù…Ø³ØªÙˆØ·Ù†', cost: [4560, 5890, 4370, 4180] }
      ],
      hun: [
        { name: 'Ù…Ø±ØªØ²Ù‚Ø©', cost: [130, 80, 40, 40], marketRate: 689 },
        { name: 'Ø±Ø§Ù…ÙŠ Ø§Ù„Ø³Ù‡Ø§Ù…', cost: [140, 110, 60, 60], marketRate: 540 },
        { name: 'Ù…Ø±Ø§Ù‚Ø¨', cost: [170, 150, 20, 40], marketRate: 526 },
        { name: 'ÙØ§Ø±Ø³ Ø§Ù„Ø³Ù‡ÙˆØ¨', cost: [290, 370, 190, 45], marketRate: 223 },
        { name: 'Ø§Ù„Ù‚Ù†Ù‘Ø§Øµ', cost: [320, 350, 330, 50], marketRate: 190 },
        { name: 'ØµØ¹Ù„ÙˆÙƒ', cost: [450, 560, 610, 140], marketRate: 113 },
        { name: 'Ù…Ø¯Ù‚Ù‘ Ø±Ø£Ø³ ÙƒØ¨Ø´', cost: [1060, 330, 360, 70], marketRate: 109 },
        { name: 'Ø§Ù„Ù…Ù†Ø¬Ù†ÙŠÙ‚', cost: [950, 1280, 620, 60], marketRate: 68 },
        { name: 'Ø®Ø§Ù†', cost: [46125, 40800, 67500, 65250] },
        { name: 'Ù…Ø³ØªÙˆØ·Ù†', cost: [8700, 7950, 10800, 8250] }
      ],
      spartan: [
        { name: 'Ù‡ÙˆØ¨Ù„ÙŠØª', cost: [110, 185, 110, 35], marketRate: 454 },
        { name: 'Ø¬Ø§Ø³ÙˆØ³', cost: [185, 150, 35, 75], marketRate: 449 },
        { name: 'Ù…Ø­Ø§Ø±Ø¨ Ø§Ù„Ø¯Ø±ÙˆØ¹', cost: [145, 95, 245, 45], marketRate: 377 },
        { name: 'Ø«ÙŠØ±ÙŠÙˆÙ†', cost: [130, 200, 400, 65], marketRate: 251 },
        { name: 'ÙØ§Ø±Ø³ Ø¥Ù„Ø¨ÙŠØ¯Ø§', cost: [555, 445, 330, 110], marketRate: 138 },
        { name: 'ÙØ§Ø±Ø³ ÙƒÙˆØ±Ù†Ø«ÙŠ', cost: [660, 495, 995, 165], marketRate: 86 },
        { name: 'ÙƒØ¨Ø´', cost: [525, 260, 790, 130], marketRate: 117 },
        { name: 'Ø§Ù„Ø¹Ø±Ù‘Ø§Ø¯Ø©', cost: [550, 1240, 825, 135], marketRate: 72 },
        { name: 'Ø¥ÙŠÙÙˆØ±', cost: [33450, 30665, 36240, 13935] },
        { name: 'Ø§Ù„Ù…Ø³ØªÙˆØ·Ù†', cost: [5115, 5580, 6045, 3255] }
      ],
      viking: [
        { name: 'Ø§Ù„Ø±Ù‚ÙŠÙ‚', cost: [5, 95, 90, 70], marketRate: 688 },
        { name: 'Ø¹Ø°Ø±Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø¹', cost: [55, 125, 80, 85], marketRate: 590 },
        { name: 'Ø§Ù„Ù‡Ø¬Ù‘Ø§Ù…', cost: [25, 130, 120, 110], marketRate: 470 },
        { name: 'Ø¹ÙŠÙ† Ù‡Ø§ÙŠÙ…Ø¯Ø§Ù„', cost: [5, 155, 95, 50], marketRate: 570 },
        { name: 'ÙØ§Ø±Ø³ Ù‡ÙˆØ³ÙƒØ§Ø±Ù„', cost: [115, 385, 295, 290], marketRate: 180 },
        { name: 'Ø§Ù„Ú¤Ø§Ù„ÙƒÙŠØ±ÙŠ', cost: [75, 475, 535, 515], marketRate: 122 },
        { name: 'ÙƒØ¨Ø´', cost: [90, 950, 325, 375], marketRate: 116 },
        { name: 'Ù…Ù†Ø¬Ù†ÙŠÙ‚', cost: [10, 850, 1225, 625], marketRate: 72 },
        { name: 'Ø§Ù„Ø¥ÙŠØ±Ù„', cost: [60, 35500, 26600, 25000] },
        { name: 'Ù…Ø³ØªÙˆØ·Ù†', cost: [80, 5800, 4600, 4800] }
      ]
    };

  function populateTroops() {
    const tribe = document.getElementById('tribeSelect').value;
    const troopSelect = document.getElementById('troopSelect');
    troopSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù†Ø¯ÙŠ âš”ï¸ --</option>';

    clearResults();

    if (!tribe || !troopData[tribe] || troopData[tribe].length === 0) {
      return;
    }

    troopData[tribe].forEach(troop => {
      const opt = document.createElement('option');
      opt.value = troop.cost.join(',');
      opt.textContent = troop.name;
      troopSelect.appendChild(opt);
    });
  }

function clearResults() {
  document.getElementById('woodCostText').textContent = '0';
  document.getElementById('clayCostText').textContent = '0';
  document.getElementById('ironCostText').textContent = '0';
  document.getElementById('wheatCostText').textContent = '0';
  document.getElementById('unitTotalCost').innerHTML = '<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ØªÙƒÙ„ÙØ©" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> Ù…Ø¬Ù…ÙˆØ¹ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ: 0';
  document.getElementById('goldCost').innerHTML = 'ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">';
  document.getElementById('troopsCount').textContent = 'ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: 0 Ø¬Ù†Ø¯ÙŠ';
  document.getElementById('totalWood').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: 0';
  document.getElementById('totalClay').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: 0';
  document.getElementById('totalIron').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: 0';
  document.getElementById('totalWheat').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: 0';
  document.getElementById('totalResourcesUsed').innerHTML = '<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: 0';
  document.getElementById('marketGoldValue').textContent = 'ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0';
}

function setTroopCosts() {
  const select = document.getElementById('troopSelect');
  if (!select.value) {
    clearResults();
    return;
  }

  const values = select.value.split(',');
  if (values.length !== 4) {
    clearResults();
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;
  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  document.getElementById('woodCostText').textContent = formatNumber(wood);
  document.getElementById('clayCostText').textContent = formatNumber(clay);
  document.getElementById('ironCostText').textContent = formatNumber(iron);
  document.getElementById('wheatCostText').textContent = formatNumber(wheat);

  const sum = wood + clay + iron + wheat;
  document.getElementById('unitTotalCost').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ØªÙƒÙ„ÙØ©" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> Ù…Ø¬Ù…ÙˆØ¹ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ: ${formatNumber(sum)}`;

  recalculate();
}

function recalculate() {
  const calcMode = getSelectedCalcMode();
  const troopSelect = document.getElementById('troopSelect');

  if (!troopSelect.value) {
    return;
  }

  if (calcMode === 'resources' && document.getElementById('totalResources').value.trim() !== '') {
    updateEstimatedTroops();
  } else if (calcMode === 'troops' && document.getElementById('customTroopCount').value.trim() !== '') {
    updateResourceTotalFromTroops();
  } else if (calcMode === 'gold' && document.getElementById('goldInput').value.trim() !== '') {
    updateFromGold();
  }
}

function updateResourceTotalFromTroops() {
  if (getSelectedCalcMode() !== 'troops') return;

  const countInput = document.getElementById('customTroopCount');
  const totalResourcesInput = document.getElementById('totalResources');
  const goldInput = document.getElementById('goldInput');
  const select = document.getElementById('troopSelect');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  const count = parseInt(countInput.value.replace(/,/g, '') || '0');
  const values = select.value.split(',');

  if (values.length !== 4 || count === 0) {
    totalResourcesInput.value = '';
    goldInput.value = '';
    document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: 0 Ø¬Ù†Ø¯ÙŠ`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: 0`;
    document.getElementById('marketGoldValue').textContent = `ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const perUnitCost = wood + clay + iron + wheat;
  const totalCost = count * perUnitCost;
  const goldCost = Math.ceil(totalCost / 55000);

  totalResourcesInput.value = formatNumber(totalCost);
  goldInput.value = formatNumber(goldCost);

  document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: ${formatNumber(goldCost)} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: ${formatNumber(count)} Ø¬Ù†Ø¯ÙŠ`;

  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: ${formatNumber(count * wood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: ${formatNumber(count * clay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: ${formatNumber(count * iron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: ${formatNumber(count * wheat)}`;

  const totalUsed = (count * wood) + (count * clay) + (count * iron) + (count * wheat);
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: ${formatNumber(totalUsed)}`;

  updateMarketValue(goldCost, select.selectedOptions[0].textContent, count);
}

function updateEstimatedTroops() {
  if (getSelectedCalcMode() !== 'resources') return;

  const totalInput = document.getElementById('totalResources');
  const troopCountInput = document.getElementById('customTroopCount');
  const goldInput = document.getElementById('goldInput');
  const select = document.getElementById('troopSelect');
  const total = parseInt(totalInput.value.replace(/,/g, '') || '0');
  const values = select.value.split(',');
  const hasArtifact = document.getElementById('reduceCostCheckbox')?.checked;

  if (values.length !== 4 || total === 0) {
    troopCountInput.value = '';
    goldInput.value = '';
    document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: 0 Ø¬Ù†Ø¯ÙŠ`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: 0`;
    document.getElementById('marketGoldValue').textContent = `ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (hasArtifact) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const totalCostPerTroop = wood + clay + iron + wheat;
  const count = Math.floor(total / totalCostPerTroop);
  const totalWood = count * wood;
  const totalClay = count * clay;
  const totalIron = count * iron;
  const totalWheat = count * wheat;
  const totalUsed = totalWood + totalClay + totalIron + totalWheat;

  troopCountInput.value = formatNumber(count);
  goldInput.value = formatNumber(Math.ceil(totalUsed / 55000));

  document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: ${formatNumber(Math.ceil(totalUsed / 55000))} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: ${formatNumber(count)} Ø¬Ù†Ø¯ÙŠ`;
  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: ${formatNumber(totalWood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: ${formatNumber(totalClay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: ${formatNumber(totalIron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: ${formatNumber(totalWheat)}`;
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: ${formatNumber(totalUsed)}`;

  updateMarketValue(Math.ceil(totalUsed / 55000), select.selectedOptions[0].textContent, count);
}

function updateFromGold() {
  if (getSelectedCalcMode() !== 'gold') return;

  const goldInput = document.getElementById('goldInput');
  const totalResourcesInput = document.getElementById('totalResources');
  const troopCountInput = document.getElementById('customTroopCount');
  const select = document.getElementById('troopSelect');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  const rawGold = goldInput.value.replace(/,/g, '').trim();

  if (rawGold === '' || parseInt(rawGold) === 0) {
    totalResourcesInput.value = '';
    troopCountInput.value = '';
    document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: 0 Ø¬Ù†Ø¯ÙŠ`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: 0`;
    document.getElementById('marketGoldValue').textContent = `ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  const gold = parseInt(rawGold) || 0;
  const values = select.value.split(',');

  if (values.length !== 4) return;

  const totalResources = gold * 55000;
  totalResourcesInput.value = formatNumber(totalResources);

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const perUnitCost = wood + clay + iron + wheat;

  const estimatedTroops = Math.floor(totalResources / perUnitCost);
  troopCountInput.value = formatNumber(estimatedTroops);

  updateMarketValue(gold, select.selectedOptions[0].textContent, estimatedTroops);

  const totalUsedWood = estimatedTroops * wood;
  const totalUsedClay = estimatedTroops * clay;
  const totalUsedIron = estimatedTroops * iron;
  const totalUsedWheat = estimatedTroops * wheat;

  document.getElementById('goldCost').innerHTML = `ğŸ’° ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°Ù‡Ø¨: ${formatNumber(gold)} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `ğŸ‘¥ ÙŠÙ…ÙƒÙ† ØªØ¯Ø±ÙŠØ¨: ${formatNumber(estimatedTroops)} Ø¬Ù†Ø¯ÙŠ`;
  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="Ø®Ø´Ø¨" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø®Ø´Ø¨: ${formatNumber(totalUsedWood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="Ø·ÙŠÙ†" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø·ÙŠÙ†: ${formatNumber(totalUsedClay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="Ø­Ø¯ÙŠØ¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ø­Ø¯ÙŠØ¯: ${formatNumber(totalUsedIron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="Ù‚Ù…Ø­" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø§Ù„Ù‚Ù…Ø­: ${formatNumber(totalUsedWheat)}`;
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="Ù…ÙˆØ§Ø±Ø¯" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯: ${formatNumber(totalUsedWood + totalUsedClay + totalUsedIron + totalUsedWheat)}`;
}

function formatNumber(num) {
  return num.toLocaleString('en-US');
}

function resetAll() {
  clearResults();

  document.getElementById('totalResources').value = '';
  document.getElementById('customTroopCount').value = '';
  document.getElementById('goldInput').value = '';
  document.getElementById('reduceCostCheckbox').checked = false;

  const tribeSelect = document.getElementById('tribeSelect');
  const troopSelect = document.getElementById('troopSelect');

  tribeSelect.selectedIndex = 0;
  troopSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù†Ø¯ÙŠ âš”ï¸ --</option>';

  document.querySelector('input[name="calcMode"][value="resources"]').checked = true;

  updateInputFieldsState();

  toggleArtifactEffects();
}

function formatInputWithCommas(input) {
  let value = input.value.replace(/,/g, '');
  if (value === '') {
    input.value = '';
    return;
  }
  if (!/^\d+$/.test(value)) {
    value = value.replace(/\D/g, '');
  }
  input.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}

function getSelectedCalcMode() {
  const radios = document.getElementsByName('calcMode');
  for (let radio of radios) {
    if (radio.checked) return radio.value;
  }
  return null;
}

function onInputHandler(type) {
  const calcMode = getSelectedCalcMode();
  if (calcMode !== type) return;

  if (type === 'resources') {
    updateEstimatedTroops();
  } else if (type === 'troops') {
    updateResourceTotalFromTroops();
  } else if (type === 'gold') {
    updateFromGold();
  }
}

function updateMarketValue(goldCount, troopName, troopCount) {
  const tribe = document.getElementById('tribeSelect').value;
  if (!tribe || !troopData[tribe] || goldCount === 0) {
    document.getElementById('marketGoldValue').textContent = 'ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: 0';
    return;
  }

  const troop = troopData[tribe].find(t => t.name === troopName);
  if (!troop || !troop.marketRate) {
    document.getElementById('marketGoldValue').textContent = 'ğŸ’¸ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù†Ø¯ÙŠ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ† Ø¨Ø§Ù„Ø°Ù‡Ø¨: ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©';
    return;
  }

  const troopsByGold = goldCount * troop.marketRate;
  document.getElementById('marketGoldValue').textContent = `ğŸ’¸ ${formatNumber(goldCount)} Ø°Ù‡Ø¨ = ${formatNumber(troopsByGold)} Ø¬Ù†Ø¯ÙŠ Ù…Ù† Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ÙŠÙ†`;
}

function updateInputFieldsState() {
  const mode = getSelectedCalcMode();
  const goldInput = document.getElementById('goldInput');
  const troopCountInput = document.getElementById('customTroopCount');
  const totalResourcesInput = document.getElementById('totalResources');

  goldInput.disabled = (mode !== 'gold');
  troopCountInput.disabled = (mode !== 'troops');
  totalResourcesInput.disabled = (mode !== 'resources');
}

function toggleArtifactEffects() {
  const container = document.querySelector('.container');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  if (isArtifactActive) {
    container.classList.add('artifact-active');
  } else {
    container.classList.remove('artifact-active');
  }
}

window.addEventListener('DOMContentLoaded', () => {
  updateInputFieldsState();
  toggleArtifactEffects();
});
</script>

</body>
</html>